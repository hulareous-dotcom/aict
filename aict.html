<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot AI 24/7 & H·ªó tr·ª£</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        
        /* Navigation Tabs */
        .nav-item { cursor: pointer; padding: 0.75rem 1rem; border-radius: 0.5rem; font-weight: 500; color: #4b5563; transition: all 0.2s; white-space: nowrap; }
        .nav-item:hover { background-color: #e5e7eb; color: #1f2937; }
        .nav-item.active { background-color: #2563eb; color: white; box-shadow: 0 4px 6px -1px rgba(37, 99, 235, 0.3); }

        /* Content Sections */
        .section-content { display: none; animation: slideUp 0.4s ease-out; }
        .section-content.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Floating Button */
        .chat-bubble-btn { position: fixed; bottom: 2rem; right: 2rem; width: 3.5rem; height: 3.5rem; background-color: #2563eb; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); cursor: pointer; z-index: 50; transition: all 0.3s ease; }
        .chat-bubble-btn:hover { transform: scale(1.1); background-color: #1d4ed8; }
        
        /* Chat Popup Box */
        .chat-widget-box { position: fixed; bottom: 6.5rem; right: 2rem; width: 380px; height: 500px; max-height: 80vh; max-width: calc(100vw - 2rem); background-color: white; border-radius: 1rem; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); display: none; flex-direction: column; overflow: hidden; z-index: 49; border: 1px solid #e5e7eb; animation: popIn 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
        .chat-widget-box.open { display: flex; }
        @keyframes popIn { from { opacity: 0; transform: translateY(20px) scale(0.95); } to { opacity: 1; transform: translateY(0) scale(1); } }

        /* Chat Messages */
        .chat-msg { max-width: 85%; padding: 0.6rem 0.8rem; border-radius: 0.8rem; font-size: 0.9rem; line-height: 1.4; margin-bottom: 0.5rem; word-wrap: break-word; }
        .chat-msg-user { background-color: #2563eb; color: white; align-self: flex-end; border-bottom-right-radius: 0.2rem; }
        .chat-msg-ai { background-color: #f3f4f6; color: #1f2937; align-self: flex-start; border: 1px solid #e5e7eb; border-bottom-left-radius: 0.2rem; }
        
        .typing-dot { display: inline-block; width: 5px; height: 5px; background-color: #9ca3af; border-radius: 50%; margin: 0 1px; animation: typing 1.4s infinite ease-in-out both; }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }

        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 5px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background-color: #d1d5db; border-radius: 10px; }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden">

    <header class="bg-white border-b border-gray-200 z-10 shadow-sm flex-none">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold mr-3">AI</div>
                    <h1 class="text-xl font-bold text-gray-900 tracking-tight">T·ªïng quan Chatbot AI 24/7</h1>
                </div>
            </div>
        </div>
    </header>

    <nav class="bg-white border-b border-gray-200 flex-none overflow-x-auto">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex space-x-1 py-3 min-w-max">
                <button onclick="switchTab('overview')" id="tab-overview" class="nav-item active">T·ªïng quan</button>
                <button onclick="switchTab('benefits')" id="tab-benefits" class="nav-item">L·ª£i √≠ch</button>
                <button onclick="switchTab('how')" id="tab-how" class="nav-item">C√°ch ho·∫°t ƒë·ªông</button>
                <button onclick="switchTab('apps')" id="tab-apps" class="nav-item">·ª®ng d·ª•ng</button>
            </div>
        </div>
    </nav>

    <main class="flex-grow overflow-y-auto bg-gray-50 custom-scroll relative">
        <div class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8 pb-24"> 

            <div id="content-overview" class="section-content active">
                <div class="bg-white rounded-2xl shadow-sm p-8 border border-gray-200">
                    <h2 class="text-3xl font-bold text-gray-900 mb-6">Chatbot AI: T∆∞∆°ng lai c·ªßa CSKH</h2>
                    <p class="text-lg text-gray-600 leading-relaxed mb-6">Chatbot AI s·ª≠ d·ª•ng Tr√≠ tu·ªá nh√¢n t·∫°o (AI) ƒë·ªÉ m√¥ ph·ªèng cu·ªôc tr√≤ chuy·ªán.</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8">
                        <div class="p-6 bg-blue-50 rounded-xl border border-blue-100">
                            <div class="text-blue-600 font-bold text-xl mb-2">24/7/365</div>
                            <p class="text-gray-600 text-sm">Ho·∫°t ƒë·ªông kh√¥ng ng·ª´ng ngh·ªâ.</p>
                        </div>
                        <div class="p-6 bg-green-50 rounded-xl border border-green-100">
                            <div class="text-green-600 font-bold text-xl mb-2">T·ª©c th√¨</div>
                            <p class="text-gray-600 text-sm">Ph·∫£n h·ªìi ngay l·∫≠p t·ª©c.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="content-benefits" class="section-content">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-white rounded-2xl shadow-sm p-6 border border-gray-200">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Bi·ªÉu ƒë·ªì L·ª£i √≠ch</h3>
                        <div class="h-64 flex justify-center"><canvas id="benefitsChart"></canvas></div>
                    </div>
                    <div class="space-y-4">
                        <div class="bg-white rounded-xl p-5 border border-gray-200 shadow-sm"><h4 class="font-semibold text-blue-700">Ti·∫øt ki·ªám Chi ph√≠</h4></div>
                        <div class="bg-white rounded-xl p-5 border border-gray-200 shadow-sm"><h4 class="font-semibold text-green-700">TƒÉng Doanh thu</h4></div>
                    </div>
                </div>
            </div>
            
            <div id="content-how" class="section-content">
                <div class="bg-white rounded-2xl shadow-sm p-8 border border-gray-200">
                    <h3 class="text-2xl font-bold text-gray-900 mb-6">C√°ch ho·∫°t ƒë·ªông</h3>
                    <p>H·ªá th·ªëng k·∫øt n·ªëi tr·ª±c ti·∫øp v·ªõi Server Node.js c·ªßa b·∫°n qua Localtunnel ƒë·ªÉ l·∫•y c√¢u tr·∫£ l·ªùi t·ª´ Gemini.</p>
                </div>
            </div>

            <div id="content-apps" class="section-content">
                 <div class="bg-white rounded-2xl shadow-sm p-8 border border-gray-200">
                    <h3 class="text-2xl font-bold text-gray-900 mb-6">·ª®ng d·ª•ng th·ª±c t·∫ø</h3>
                    <p>H·ªó tr·ª£ kh√°ch h√†ng, T∆∞ v·∫•n b√°n h√†ng, Tra c·ª©u th√¥ng tin...</p>
                </div>
            </div>

        </div>
    </main>

    <div id="chat-widget" class="chat-widget-box">
        <div class="bg-gray-900 text-white px-4 py-3 flex justify-between items-center flex-none cursor-pointer" onclick="toggleChat()">
            <div class="flex items-center">
                <div class="w-2 h-2 bg-green-500 rounded-full mr-2 animate-pulse"></div>
                <h3 class="font-bold text-sm">H·ªó tr·ª£ tr·ª±c tuy·∫øn</h3>
            </div>
            <button class="text-gray-400 hover:text-white">‚úï</button>
        </div>

        <div id="chat-status" class="bg-gray-100 text-xs text-center py-1 text-gray-500 border-b border-gray-200">
            ƒêang k·∫øt n·ªëi...
        </div>

        <div id="chat-window" class="flex-grow p-4 overflow-y-auto custom-scroll bg-white flex flex-col">
            <div class="chat-msg chat-msg-ai">üëã Xin ch√†o! T√¥i l√† tr·ª£ l√Ω ·∫£o AI.<br>T√¥i c√≥ th·ªÉ gi√∫p g√¨ cho b·∫°n?</div>
        </div>

        <div class="p-3 bg-gray-50 border-t border-gray-200 flex-none">
            <form id="chat-form" class="flex gap-2">
                <input type="text" id="chat-input" class="flex-grow px-3 py-2 rounded-lg border border-gray-300 outline-none text-sm" placeholder="Nh·∫≠p tin nh·∫Øn..." autocomplete="off" disabled>
                <button type="submit" id="chat-send-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg font-semibold transition disabled:opacity-50 flex items-center justify-center" disabled>G·ª≠i</button>
            </form>
        </div>
    </div>

    <button onclick="toggleChat()" class="chat-bubble-btn" title="Chat v·ªõi ch√∫ng t√¥i">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
        </svg>
    </button>

    <script>
        // 1. Logic Chuy·ªÉn Tab & Giao di·ªán (ƒê√£ kh√¥i ph·ª•c)
        function switchTab(tabId) {
            document.querySelectorAll('.section-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            document.getElementById(`content-${tabId}`).classList.add('active');
            document.getElementById(`tab-${tabId}`).classList.add('active');
            
            if (tabId === 'benefits' && !window.chartInitialized) initChart();
        }

        function toggleChat() {
            const chatBox = document.getElementById('chat-widget');
            chatBox.classList.toggle('open');
        }

        function initChart() {
            const ctx = document.getElementById('benefitsChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Tr·∫£i nghi·ªám', 'Kinh doanh'],
                    datasets: [{ data: [55, 45], backgroundColor: ['#3b82f6', '#10b981'], borderWidth: 0 }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } }
            });
            window.chartInitialized = true;
        }

        // 2. Logic K·∫øt n·ªëi AI (ƒê√£ s·ª≠a link c·ªßa b·∫°n)
        const firebaseConfig = {
            apiKey: "AIzaSyBMUvMykvoYX43Xl2LtZKKwN9IsBLN41Qs",
            authDomain: "aict-3d755.firebaseapp.com",
            projectId: "aict-3d755",
            storageBucket: "aict-3d755.firebasestorage.app",
            messagingSenderId: "30673828530",
            appId: "1:30673828530:web:7e4df9420ab25efcd167ab",
            measurementId: "G-3T9PB6P6SC"
        };

        try {
            // Kh·ªüi t·∫°o Firebase
            firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();
            const auth = firebase.auth();
            const messagesRef = db.collection('chats').doc('global_room').collection('messages');

            const statusEl = document.getElementById('chat-status');
            const inputEl = document.getElementById('chat-input');
            const btnEl = document.getElementById('chat-send-btn');
            const chatWindow = document.getElementById('chat-window');

            // ƒêƒÉng nh·∫≠p
            auth.signInAnonymously().catch(console.error);
            auth.onAuthStateChanged(user => {
                if (user) {
                    statusEl.textContent = "ƒê√£ k·∫øt n·ªëi Server";
                    statusEl.className = "bg-green-100 text-xs text-center py-1 text-green-700 border-b border-green-200";
                    inputEl.disabled = false;
                    btnEl.disabled = false;
                    setupChatListeners();
                } else {
                    statusEl.textContent = "M·∫•t k·∫øt n·ªëi";
                    inputEl.disabled = true;
                    btnEl.disabled = true;
                }
            });

            // L·∫Øng nghe tin nh·∫Øn
            function setupChatListeners() {
                messagesRef.orderBy('timestamp', 'asc').onSnapshot(snapshot => {
                    chatWindow.innerHTML = `<div class="chat-msg chat-msg-ai">üëã Xin ch√†o! T√¥i l√† tr·ª£ l√Ω ·∫£o AI.<br>T√¥i c√≥ th·ªÉ gi√∫p g√¨ cho b·∫°n?</div>`;
                    snapshot.forEach(doc => {
                        const data = doc.data();
                        renderMessage(data.text, data.sender);
                    });
                    chatWindow.scrollTop = chatWindow.scrollHeight;
                });
            }

            // G·ª¨I TIN NH·∫ÆN V√Ä G·ªåI GEMINI
            document.getElementById('chat-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const text = inputEl.value.trim();
                if (!text) return;

                inputEl.value = '';
                
                // 1. L∆∞u tin User
                await messagesRef.add({ text: text, sender: 'user', timestamp: firebase.firestore.FieldValue.serverTimestamp() });

                // 2. Hi·ªán hi·ªáu ·ª©ng g√µ
                const typingId = showTyping();

                // 3. G·ªåI SERVER (LINK C·ª¶A B·∫†N ƒê√ÇY)
                const aiReply = await callGeminiAPI(text);

                // 4. L∆∞u tin AI
                removeTyping(typingId);
                await messagesRef.add({ text: aiReply, sender: 'ai', timestamp: firebase.firestore.FieldValue.serverTimestamp() });
            });

        } catch (error) {
            console.error("L·ªói:", error);
        }

        // H√†m g·ªçi API (C√≥ bypass tunnel)
        async function callGeminiAPI(message) {
            try {
                const response = await fetch('https://witty-papers-call.loca.lt/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Bypass-Tunnel-Reminder': 'true' },
                    body: JSON.stringify({ message: message })
                });
                const data = await response.json();
                return data.reply;
            } catch (error) {
                console.error("L·ªói:", error);
                return "L·ªói k·∫øt n·ªëi! (Ki·ªÉm tra xem c·ª≠a s·ªï ƒëen localtunnel c√≤n ch·∫°y kh√¥ng?)";
            }
        }

        // C√°c h√†m ph·ª• tr·ª£
        function renderMessage(text, sender) {
            const div = document.createElement('div');
            div.className = sender === 'user' ? 'chat-msg chat-msg-user' : 'chat-msg chat-msg-ai';
            div.innerHTML = text ? text.replace(/\n/g, '<br>') : '...';
            document.getElementById('chat-window').appendChild(div);
        }

        function showTyping() {
            const div = document.createElement('div');
            const id = 'typing-' + Date.now();
            div.id = id;
            div.className = 'chat-msg chat-msg-ai';
            div.innerHTML = `<span class="typing-dot"></span><span class="typing-dot"></span><span class="typing-dot"></span>`;
            document.getElementById('chat-window').appendChild(div);
            document.getElementById('chat-window').scrollTop = document.getElementById('chat-window').scrollHeight;
            return id;
        }

        function removeTyping(id) {
            const el = document.getElementById(id);
            if (el) el.remove();
        }
    </script>
</body>
</html>
